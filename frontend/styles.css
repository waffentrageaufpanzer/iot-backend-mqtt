:root {
  --bg: #020617;
  --bg-grad: radial-gradient(circle at top left, #1e293b 0, transparent 55%), radial-gradient(circle at bottom right, #0f766e 0, transparent 60%), #020617;
  --card: rgba(15, 23, 42, 0.96); --card-soft: rgba(15, 23, 42, 0.9);
  --border: rgba(148, 163, 184, 0.35); --border-sub: rgba(31, 41, 55, 0.95);
  --acc: #22c55e; --acc-soft: rgba(34, 197, 94, 0.16);
  --acc2: #38bdf8; --acc2-soft: rgba(56, 189, 248, 0.16);
  --danger: #ef4444; --danger-soft: rgba(248, 113, 113, 0.16);
  --text: #e5e7eb; --text-soft: #9ca3af;
  --shad: 0 10px 28px rgba(15, 23, 42, 0.9);
  --rad: 14px; --pill: 999px;
  --trans: all 0.18s ease-out;
  
  --grid-cols: 12; --grid-row: 90px;
}

[data-theme="light"] {
  --bg: #f3f4f6; --bg-grad: #f3f4f6;
  --card: #ffffff; --card-soft: #f9fafb;
  --border: #e5e7eb; --border-sub: #cbd5f5;
  --text: #0f172a; --text-soft: #6b7280;
  --shad: 0 8px 18px rgba(15, 23, 42, 0.1);
}

* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: system-ui, sans-serif; background: var(--bg-grad); color: var(--text); min-height: 100vh; background-attachment: fixed; }

/* UTILS */
.full-center { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 10px; }
.row { display: flex; flex-direction: column; gap: 5px; margin-top: 5px; }
.small { font-size: 12px; color: var(--text-soft); }
.pill { padding: 2px 8px; border-radius: var(--pill); font-size: 11px; border: 1px solid var(--border-sub); background: var(--card-soft); }

/* INPUTS & BUTTONS */
input, select, textarea {
  background: var(--card-soft); border: 1px solid var(--border-sub); border-radius: var(--pill);
  padding: 6px 12px; color: var(--text); width: 100%; outline: none; transition: var(--trans);
}
input:focus, select:focus { border-color: var(--acc2); box-shadow: 0 0 0 1px var(--acc2-soft); }

button {
  cursor: pointer; border: none; border-radius: var(--pill); padding: 6px 12px; font-size: 12px; font-weight: 600;
  background: linear-gradient(135deg, var(--acc), #4ade80); color: #020617; transition: var(--trans);
}
button:hover { transform: translateY(-1px); filter: brightness(1.1); }
button:disabled { opacity: 0.6; cursor: default; transform: none; }

button.secondary { background: var(--card); color: var(--text); border: 1px solid var(--border-sub); }
button.danger { background: linear-gradient(135deg, var(--danger), #fb923c); color: white; }
button.btn-sm { padding: 4px 8px; font-size: 11px; }
.icon-btn { width: 28px; height: 28px; padding: 0; display: inline-flex; align-items: center; justify-content: center; background: var(--card-soft); border: 1px solid var(--border-sub); color: var(--text); border-radius: 50%; }

/* AUTH CARD */
.auth-card { width: 100%; max-width: 360px; background: var(--card); border: 1px solid var(--border); border-radius: var(--rad); padding: 20px; box-shadow: var(--shad); }
.auth-topbar { display: flex; justify-content: space-between; margin-bottom: 10px; }
.auth-title { font-size: 20px; font-weight: 700; margin-bottom: 15px; text-align: center; }
.tabs { display: flex; background: var(--card-soft); padding: 3px; border-radius: var(--pill); margin: 10px 0; }
.tabs button { flex: 1; background: transparent; color: var(--text-soft); box-shadow: none; }
.tabs button.active { background: var(--acc2); color: #000; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }

/* APP LAYOUT */
.layout {
  display: grid; grid-template-columns: 220px 1fr 300px; gap: 15px;
  max-width: 1600px; margin: 0 auto; padding: 15px; height: 100vh; overflow: hidden;
}
@media (max-width: 1024px) { .layout { grid-template-columns: 60px 1fr; } .detail-card { display: none !important; } }
@media (max-width: 640px) { .layout { grid-template-columns: 1fr; grid-template-rows: auto 1fr; } .sidebar { width: 100%; height: auto; flex-direction: row; } }

/* SIDEBAR */
.sidebar { background: var(--card); border: 1px solid var(--border); border-radius: var(--rad); padding: 10px; display: flex; flex-direction: column; gap: 5px; }
.sidebar-top { display: flex; justify-content: space-between; padding: 0 5px 10px; align-items: center; }
.sidebar-logo { font-weight: 800; letter-spacing: 1px; color: var(--acc2); }
.nav-item { width: 100%; justify-content: flex-start; background: transparent; color: var(--text-soft); box-shadow: none; }
.nav-item:hover, .nav-item.active { background: var(--acc2-soft); color: var(--acc2); }
.nav-item.active { border: 1px solid var(--acc2); }
.layout:has(.sidebar:not(:hover)) .nav-label { display: none; } /* Mobile/Collapsed logic handled by Grid */

/* MAIN CONTENT */
.card { background: var(--card); border: 1px solid var(--border); border-radius: var(--rad); padding: 15px; overflow-y: auto; position: relative; }
.app-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
.app-title-text { font-size: 18px; font-weight: 700; color: var(--text); }

/* DASHBOARD GRID */
.dash-toolbar { display: flex; justify-content: space-between; margin-bottom: 10px; flex-wrap: wrap; gap: 10px; }
.widget-grid {
  display: grid; grid-template-columns: repeat(var(--grid-cols), 1fr); grid-auto-rows: var(--grid-row); gap: 10px;
  min-height: calc(100vh - 150px); align-content: start;
}
.widgets-edit {
  border: 2px dashed var(--border); background-image: radial-gradient(var(--border) 1px, transparent 1px); background-size: 20px 20px;
}

/* WIDGET CARD */
.widget-card {
  background: var(--card-soft); border: 1px solid var(--border-sub); border-radius: var(--rad); padding: 10px;
  display: flex; flex-direction: column; gap: 5px; position: relative; overflow: hidden; transition: box-shadow 0.2s;
  grid-column: span 4; grid-row: span 2; /* Default */
}
.widget-card:hover { box-shadow: 0 5px 15px rgba(0,0,0,0.3); border-color: var(--acc2); }
.widget-header { display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: var(--text-soft); }
.widget-title { font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 120px; }
.widget-body { flex: 1; display: flex; align-items: center; justify-content: center; flex-direction: column; }

/* WIDGET TYPES */
.widget-value-big { font-size: 24px; font-weight: 700; color: var(--acc); }
.widget-switch-btn {
  background: var(--card); border: 1px solid var(--border); border-radius: var(--pill); padding: 4px; display: flex; align-items: center; gap: 8px; cursor: pointer;
}
.widget-switch-btn.on { border-color: var(--acc); background: var(--acc-soft); }
.widget-switch-track { width: 36px; height: 20px; background: #334155; border-radius: var(--pill); position: relative; transition: 0.2s; }
.widget-switch-thumb { width: 16px; height: 16px; background: white; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: 0.2s; }
.widget-switch-btn.on .widget-switch-track { background: var(--acc); }
.widget-switch-btn.on .widget-switch-thumb { transform: translateX(16px); }

.widget-slider-row { width: 100%; display: flex; gap: 10px; align-items: center; }
.widget-gauge-bar { width: 100%; height: 8px; background: #334155; border-radius: var(--pill); overflow: hidden; margin-top: 5px; }
.widget-gauge-fill { height: 100%; background: linear-gradient(90deg, var(--acc2), var(--acc)); transition: width 0.3s; }

.dpad { display: grid; grid-template-rows: repeat(3, 1fr); gap: 2px; justify-items: center; }
.dpad-btn { width: 30px; height: 30px; padding: 0; background: var(--border-sub); }

/* TABLES & LISTS */
table { width: 100%; border-collapse: collapse; font-size: 13px; }
th, td { padding: 8px; text-align: left; border-bottom: 1px solid var(--border-sub); }
th { color: var(--text-soft); font-weight: 600; }
tr:hover td { background: var(--acc-soft); }

/* POPUP CONFIG */
.widget-config-overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 100;
  display: none; align-items: center; justify-content: center; backdrop-filter: blur(2px);
}
.widget-config-overlay.open { display: flex; }
.widget-config { background: var(--card); border: 1px solid var(--acc2); padding: 20px; border-radius: var(--rad); width: 320px; box-shadow: var(--shad); }
.widget-config-header { display: flex; justify-content: space-between; margin-bottom: 15px; font-weight: 700; font-size: 16px; }
.widget-config-row { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
.widget-config-row span { width: 80px; font-size: 13px; color: var(--text-soft); }

/* PALETTE MENU */
.widget-palette { position: relative; }
.widget-palette-menu {
  position: absolute; right: 0; top: 110%; background: var(--card); border: 1px solid var(--border);
  border-radius: var(--rad); padding: 5px; display: none; flex-direction: column; gap: 2px; min-width: 140px; z-index: 10;
}
.widget-palette-menu.open { display: flex; }
.widget-type-btn { background: transparent; text-align: left; color: var(--text); box-shadow: none; border-radius: 4px; }
.widget-type-btn:hover { background: var(--acc2-soft); }

/* MISC */
.badge-online { color: var(--acc); background: var(--acc-soft); padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 700; }
.badge-offline { color: var(--danger); background: var(--danger-soft); padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 700; }
video, img.cam-preview { width: 100%; border-radius: var(--rad); background: #000; object-fit: cover; }