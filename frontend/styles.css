:root {
  /* --- BASE COLORS --- */
  --bg-color: #e0e5ec;
  --text-color: #4a5568;
  --text-soft: #a0aec0;
  
  /* NEUMORPHISM SHADOWS (LIGHT MODE DEFAULT) */
  --neu-shadow-light: #ffffff;
  --neu-shadow-dark: #a3b1c6;
  
  /* ACCENT COLORS */
  --acc: #10b981; /* Green */
  --acc-soft: rgba(16, 185, 129, 0.15);
  --acc2: #3b82f6; /* Blue */
  --acc2-soft: rgba(59, 130, 246, 0.15);
  --danger: #ef4444; /* Red */
  --danger-soft: rgba(239, 68, 68, 0.15);
  
  /* GRID SYSTEM */
  --grid-cols: 12;
  --grid-row-height: 90px;
  
  /* UTILS */
  --rad: 20px;
  --pill: 999px;
  --trans: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

/* DARK MODE OVERRIDES */
[data-theme="dark"] {
  --bg-color: #2d3748;
  --text-color: #e2e8f0;
  --text-soft: #718096;
  --neu-shadow-light: #3a475c;
  --neu-shadow-dark: #1a202c;
}

/* --- RESET & GLOBAL --- */
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }
body {
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  background-color: var(--bg-color);
  color: var(--text-color);
  transition: background-color 0.3s ease, color 0.3s ease;
  overflow-x: hidden;
}

/* --- UTILITIES --- */
.full-center { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 15px; }
.hidden { display: none !important; }
.row { display: flex; gap: 10px; margin-bottom: 10px; }
.small { font-size: 12px; color: var(--text-soft); }
.pill { padding: 2px 8px; border-radius: var(--pill); font-size: 11px; font-weight: 600; box-shadow: inset 2px 2px 5px var(--neu-shadow-dark), inset -2px -2px 5px var(--neu-shadow-light); }

/* --- NEUMORPHISM BUTTONS & INPUTS --- */
/* Nút chữ nhật bo góc (Dùng cho menu, form) */
.btn-neu-rect {
  border: none; outline: none; cursor: pointer;
  background: var(--bg-color); color: var(--text-color);
  padding: 10px 20px; border-radius: 12px;
  font-weight: 600; font-size: 13px; text-transform: uppercase; letter-spacing: 0.5px;
  box-shadow: 6px 6px 12px var(--neu-shadow-dark), -6px -6px 12px var(--neu-shadow-light);
  transition: var(--trans);
  display: inline-flex; align-items: center; justify-content: center; gap: 8px;
}
.btn-neu-rect:hover:not(:disabled) { transform: translateY(-2px); color: var(--acc2); }
.btn-neu-rect:active:not(:disabled), .btn-neu-rect.active {
  box-shadow: inset 4px 4px 8px var(--neu-shadow-dark), inset -4px -4px 8px var(--neu-shadow-light);
  transform: translateY(0); color: var(--acc);
}
.btn-neu-rect:disabled { opacity: 0.6; cursor: not-allowed; box-shadow: none; }

/* Nút tròn nhỏ (Icon button) */
.icon-btn {
  width: 36px; height: 36px; border-radius: 50%; border: none; cursor: pointer;
  background: var(--bg-color); color: var(--text-color);
  display: flex; align-items: center; justify-content: center; font-size: 16px;
  box-shadow: 5px 5px 10px var(--neu-shadow-dark), -5px -5px 10px var(--neu-shadow-light);
  transition: var(--trans);
}
.icon-btn:hover { color: var(--acc2); transform: scale(1.05); }
.icon-btn:active { box-shadow: inset 3px 3px 6px var(--neu-shadow-dark), inset -3px -3px 6px var(--neu-shadow-light); }

/* Input Fields (Lõm xuống) */
input, select, textarea {
  width: 100%; border: none; outline: none;
  background: var(--bg-color); color: var(--text-color);
  padding: 12px 15px; border-radius: 10px; font-size: 14px;
  box-shadow: inset 4px 4px 8px var(--neu-shadow-dark), inset -4px -4px 8px var(--neu-shadow-light);
  transition: var(--trans); margin-bottom: 10px;
}
input:focus, select:focus { box-shadow: inset 6px 6px 12px var(--neu-shadow-dark), inset -6px -6px 12px var(--neu-shadow-light); color: var(--acc2); }

/* --- AUTH PAGE --- */
.auth-card {
  width: 100%; max-width: 400px; padding: 40px; border-radius: 30px;
  background: var(--bg-color);
  box-shadow: 10px 10px 20px var(--neu-shadow-dark), -10px -10px 20px var(--neu-shadow-light);
}
.auth-topbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
.auth-title { font-size: 24px; font-weight: 800; color: var(--text-color); letter-spacing: -0.5px; }
.tabs { display: flex; gap: 15px; margin-bottom: 25px; }
.tabs button { flex: 1; }

/* --- LAYOUT STRUCTURE --- */
.layout {
  display: grid; grid-template-columns: 240px 1fr 320px; gap: 25px;
  max-width: 1600px; margin: 0 auto; padding: 25px; height: 100vh;
}
/* Responsive */
@media (max-width: 1200px) { .layout { grid-template-columns: 240px 1fr; } .detail-card { display: none !important; } }
@media (max-width: 768px) { .layout { grid-template-columns: 1fr; padding: 15px; height: auto; } .sidebar { position: sticky; top: 0; z-index: 100; margin-bottom: 20px; } .sidebar-nav { flex-direction: row; overflow-x: auto; padding-bottom: 5px; } .nav-item { min-width: 100px; } }

/* Sidebar & Cards */
.sidebar, .card, .detail-card {
  background: var(--bg-color); border-radius: 25px; padding: 25px;
  box-shadow: 8px 8px 16px var(--neu-shadow-dark), -8px -8px 16px var(--neu-shadow-light);
  display: flex; flex-direction: column; overflow: hidden;
}
.sidebar-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
.sidebar-logo { font-weight: 900; font-size: 18px; color: var(--acc); letter-spacing: 1px; }
.sidebar-nav { display: flex; flex-direction: column; gap: 12px; }
.nav-item { width: 100%; justify-content: flex-start; padding-left: 20px; } /* Override btn-neu-rect */

.main-content {
  background: var(--bg-color); border-radius: 25px; padding: 25px; overflow-y: auto;
  box-shadow: inset 6px 6px 12px var(--neu-shadow-dark), inset -6px -6px 12px var(--neu-shadow-light);
}

.app-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
.app-title-text { font-size: 22px; font-weight: 700; }

/* --- DASHBOARD GRID --- */
.dash-toolbar { display: flex; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; gap: 15px; }
.widget-grid {
  display: grid; grid-template-columns: repeat(var(--grid-cols), 1fr); 
  grid-auto-rows: var(--grid-row-height); gap: 20px; padding: 5px;
  min-height: 500px;
}
.widgets-edit {
  border-radius: 15px; border: 2px dashed var(--text-soft);
  background-image: radial-gradient(var(--text-soft) 1px, transparent 1px); background-size: 20px 20px;
}

/* --- WIDGET CARD --- */
.widget-card {
  background: var(--bg-color); border-radius: 20px; padding: 15px;
  box-shadow: 6px 6px 12px var(--neu-shadow-dark), -6px -6px 12px var(--neu-shadow-light);
  display: flex; flex-direction: column; justify-content: space-between;
  transition: transform 0.2s; position: relative;
}
.widget-card:hover { transform: translateY(-3px); }
.widget-header { display: flex; justify-content: space-between; font-size: 13px; font-weight: 600; color: var(--text-soft); margin-bottom: 10px; }
.widget-body { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }

/* --- WIDGET COMPONENTS (VISUALS) --- */

/* 1. Switch (Nút tròn nổi) */
.widget-switch-btn {
  width: 60px; height: 60px; border-radius: 50%; border: none; cursor: pointer;
  background: var(--bg-color); color: var(--text-soft); font-size: 24px;
  display: flex; align-items: center; justify-content: center; position: relative;
  box-shadow: 6px 6px 12px var(--neu-shadow-dark), -6px -6px 12px var(--neu-shadow-light);
  transition: var(--trans);
}
.widget-switch-btn::after { content: "⏻"; position: absolute; }
.widget-switch-btn.on { color: var(--acc); box-shadow: inset 4px 4px 8px var(--neu-shadow-dark), inset -4px -4px 8px var(--neu-shadow-light); }
.widget-switch-label, .widget-switch-track, .widget-switch-thumb { display: none; } /* Ẩn style cũ */

/* 2. Slider */
.widget-slider-row { width: 100%; display: flex; flex-direction: column; gap: 5px; align-items: center; }
.widget-slider-row input[type=range] {
  -webkit-appearance: none; width: 100%; height: 10px; border-radius: 5px; padding: 0; margin: 10px 0;
  background: var(--bg-color);
  box-shadow: inset 2px 2px 5px var(--neu-shadow-dark), inset -2px -2px 5px var(--neu-shadow-light);
}
.widget-slider-row input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%; background: var(--acc2); cursor: pointer;
  box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
}

/* 3. Button (Nhấn giữ) */
.widget-action-btn {
  width: 80px; height: 80px; border-radius: 50%; border: none;
  background: var(--bg-color); color: var(--acc2); font-weight: 900; font-size: 14px;
  box-shadow: 8px 8px 16px var(--neu-shadow-dark), -8px -8px 16px var(--neu-shadow-light);
  display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 5px;
  transition: var(--trans); cursor: active;
}
.widget-action-btn:active { transform: scale(0.95); box-shadow: inset 4px 4px 8px var(--neu-shadow-dark), inset -4px -4px 8px var(--neu-shadow-light); color: var(--acc); }
.widget-action-dot { width: 8px; height: 8px; border-radius: 50%; background: currentColor; box-shadow: 0 0 5px currentColor; }

/* 4. Thermo & Gauge & Value */
.widget-value-big { font-size: 28px; font-weight: 800; color: var(--text-color); text-shadow: 1px 1px 2px var(--neu-shadow-light); }
.widget-gauge-bar { width: 80%; height: 10px; border-radius: 10px; background: var(--bg-color); box-shadow: inset 2px 2px 5px var(--neu-shadow-dark), inset -2px -2px 5px var(--neu-shadow-light); overflow: hidden; margin-top: 8px; }
.widget-gauge-fill { height: 100%; background: var(--acc); transition: width 0.3s; box-shadow: 0 0 10px var(--acc-soft); }

/* 5. D-Pad */
.widget-dpad { display: flex; flex-direction: column; gap: 5px; align-items: center; }
.widget-dpad-row { display: flex; gap: 5px; }
.dpad-btn {
  width: 35px; height: 35px; border-radius: 8px; border: none; background: var(--bg-color);
  box-shadow: 3px 3px 6px var(--neu-shadow-dark), -3px -3px 6px var(--neu-shadow-light);
  display: flex; align-items: center; justify-content: center; cursor: pointer; color: var(--text-color);
}
.dpad-btn:active { box-shadow: inset 2px 2px 4px var(--neu-shadow-dark), inset -2px -2px 4px var(--neu-shadow-light); color: var(--acc2); }

/* --- LISTS & TABLES --- */
.device-list-wrapper {
  max-height: 400px; overflow-y: auto; padding: 10px;
  border-radius: 15px; background: var(--bg-color);
  box-shadow: inset 4px 4px 8px var(--neu-shadow-dark), inset -4px -4px 8px var(--neu-shadow-light);
}
table { width: 100%; border-collapse: collapse; font-size: 14px; }
th { text-align: left; padding: 10px; color: var(--text-soft); font-weight: 600; border-bottom: 1px solid var(--text-soft); opacity: 0.5; }
td { padding: 12px 10px; border-bottom: 1px solid rgba(0,0,0,0.05); }
tr:last-child td { border: none; }

/* Status Badges */
.badge-online { color: var(--acc); font-weight: bold; text-shadow: 0 0 10px var(--acc-soft); }
.badge-offline { color: var(--danger); font-weight: bold; }

/* --- POPUPS & MENUS --- */
.widget-palette-menu {
  position: absolute; right: 0; top: 120%; background: var(--bg-color);
  padding: 15px; border-radius: 15px; z-index: 50; display: none; flex-direction: column; gap: 8px; min-width: 160px;
  box-shadow: 10px 10px 20px var(--neu-shadow-dark), -10px -10px 20px var(--neu-shadow-light);
}
.widget-palette-menu.open { display: flex; }
.widget-type-btn {
  text-align: left; background: transparent; border: none; padding: 8px; cursor: pointer; color: var(--text-color); font-weight: 500; border-radius: 8px;
}
.widget-type-btn:hover { background: rgba(0,0,0,0.05); color: var(--acc2); }

.widget-config-overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(3px); z-index: 100;
  display: none; align-items: center; justify-content: center;
}
.widget-config-overlay.open { display: flex; }
.widget-config {
  width: 350px; background: var(--bg-color); padding: 30px; border-radius: 25px;
  box-shadow: 15px 15px 30px var(--neu-shadow-dark), -15px -15px 30px var(--neu-shadow-light);
}
.widget-config-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; font-weight: 800; font-size: 18px; }
.widget-config-row { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
.widget-config-row span { width: 90px; font-size: 13px; font-weight: 600; color: var(--text-soft); }

/* --- OTHER --- */
img.cam-preview { width: 100%; border-radius: 15px; box-shadow: 5px 5px 10px var(--neu-shadow-dark), -5px -5px 10px var(--neu-shadow-light); }
video { width: 100%; border-radius: 15px; box-shadow: inset 4px 4px 8px var(--neu-shadow-dark), inset -4px -4px 8px var(--neu-shadow-light); background: #000; }